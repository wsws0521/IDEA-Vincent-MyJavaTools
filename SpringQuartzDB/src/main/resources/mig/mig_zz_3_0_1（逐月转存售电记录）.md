-- 建表语句（近5年按月分区）
```sql
CREATE TABLE `tmp_sdjl_2013` LIKE `tmp_sdjl_2015`;
ALTER TABLE `tmp_sdjl_2013`
PARTITION BY RANGE (TO_DAYS(OD_DATE))(
    PARTITION P201301 VALUES LESS THAN (TO_DAYS('2013-02-01')) ENGINE = InnoDB,
    PARTITION P201302 VALUES LESS THAN (TO_DAYS('2013-03-01')) ENGINE = InnoDB,
    PARTITION P201303 VALUES LESS THAN (TO_DAYS('2013-04-01')) ENGINE = InnoDB,
    PARTITION P201304 VALUES LESS THAN (TO_DAYS('2013-05-01')) ENGINE = InnoDB,
    PARTITION P201305 VALUES LESS THAN (TO_DAYS('2013-06-01')) ENGINE = InnoDB,
    PARTITION P201306 VALUES LESS THAN (TO_DAYS('2013-07-01')) ENGINE = InnoDB,
    PARTITION P201307 VALUES LESS THAN (TO_DAYS('2013-08-01')) ENGINE = InnoDB,
    PARTITION P201308 VALUES LESS THAN (TO_DAYS('2013-09-01')) ENGINE = InnoDB,
    PARTITION P201309 VALUES LESS THAN (TO_DAYS('2013-10-01')) ENGINE = InnoDB,
    PARTITION P201310 VALUES LESS THAN (TO_DAYS('2013-11-01')) ENGINE = InnoDB,
    PARTITION P201311 VALUES LESS THAN (TO_DAYS('2013-12-01')) ENGINE = InnoDB,
    PARTITION P201312 VALUES LESS THAN (TO_DAYS('2014-01-01')) ENGINE = InnoDB,
    PARTITION PMAX VALUES LESS THAN (MAXVALUE)
);

CREATE TABLE `tmp_sdjl_2014` LIKE `tmp_sdjl_2015`;
ALTER TABLE `tmp_sdjl_2014`
PARTITION BY RANGE (TO_DAYS(OD_DATE))(
    PARTITION P201401 VALUES LESS THAN (TO_DAYS('2014-02-01')) ENGINE = InnoDB,
    PARTITION P201402 VALUES LESS THAN (TO_DAYS('2014-03-01')) ENGINE = InnoDB,
    PARTITION P201403 VALUES LESS THAN (TO_DAYS('2014-04-01')) ENGINE = InnoDB,
    PARTITION P201404 VALUES LESS THAN (TO_DAYS('2014-05-01')) ENGINE = InnoDB,
    PARTITION P201405 VALUES LESS THAN (TO_DAYS('2014-06-01')) ENGINE = InnoDB,
    PARTITION P201406 VALUES LESS THAN (TO_DAYS('2014-07-01')) ENGINE = InnoDB,
    PARTITION P201407 VALUES LESS THAN (TO_DAYS('2014-08-01')) ENGINE = InnoDB,
    PARTITION P201408 VALUES LESS THAN (TO_DAYS('2014-09-01')) ENGINE = InnoDB,
    PARTITION P201409 VALUES LESS THAN (TO_DAYS('2014-10-01')) ENGINE = InnoDB,
    PARTITION P201410 VALUES LESS THAN (TO_DAYS('2014-11-01')) ENGINE = InnoDB,
    PARTITION P201411 VALUES LESS THAN (TO_DAYS('2014-12-01')) ENGINE = InnoDB,
    PARTITION P201412 VALUES LESS THAN (TO_DAYS('2015-01-01')) ENGINE = InnoDB,
    PARTITION PMAX VALUES LESS THAN (MAXVALUE)
);

-- select count(1) from tmp_sdjl_2015 where tv >= '2015-10-01 00:00:00'
-- SQLSERVER 查询语句（hxdb20200416备份版本）（当月数据少注意是不是 网络中断 unsuccessfully，需要删除对应月份已插部分数据，重新导入）
-- 2015-01：946146 数据+3，导入耗时 1006（81.6）
-- 2015-02：828346 数据+2，导入耗时 956
-- 2015-03：929386 数据+8，导入耗时 928
-- 2015-04：909979 数据+0，导入耗时 866
-- 2015-05：978633 数据+1，导入耗时 997
-- 2015-06：1094483 数据+1，导入耗时 1098
-- 2015-07：1336759 数据+0，导入耗时 1313
-- 2015-08：1276217 数据+0，导入耗时 1306
-- 2015-09：986108 数据+1，导入耗时 998
-- 2015-10：1008003 数据+10，导入耗时 1018       select * from tmp_sdjl where tv between '2015-10-01 00:00:00' and '2015-11-01 00:00:00';
-- 2015-11：994642 数据+0，导入耗时 1119
-- 2015-12：1004414 数据+0，导入耗时 1085       select * from tmp_sdjl where tv between '2015-12-01 00:00:00' and '2016-01-01 00:00:00';
-- 12293116+26 = 12293142
CREATE TABLE `tmp_sdjl_2015` (
  `ORDERSID` varchar(32) NOT NULL,
  `MT_COMM_ADDR` varchar(32) DEFAULT NULL,
  `OD_DATE` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `ISFREE` TINYINT UNSIGNED,
  `CUSTOMER_ID` MEDIUMINT UNSIGNED,
  `SGC_OLD` varchar(8) DEFAULT NULL,
  `TI_OLD` TINYINT UNSIGNED,
  `KEYVERSIONID_OLD` TINYINT UNSIGNED,
  `KEYEXPIRY_OLD` TINYINT UNSIGNED,
  `SGC` varchar(8) DEFAULT NULL,
  `TI` TINYINT UNSIGNED,
  `KEYVERSIONID` TINYINT UNSIGNED,
  `KEYEXPIRY` TINYINT UNSIGNED,
  `OCD_TOKEN` varchar(32) DEFAULT NULL,
  `KEYTOKEN1` varchar(32) DEFAULT NULL,
  `KEYTOKEN2` varchar(32) DEFAULT NULL,
  `OCD_ENERGY` decimal(18,2) DEFAULT NULL,
  `OCD_MONEY` decimal(18,2) DEFAULT NULL,
  `PAYTYPE` TINYINT UNSIGNED,
  `FP_VAL3` decimal(18,2) DEFAULT NULL,
  `OCD_DEBT` decimal(18,2) DEFAULT NULL,
  `DEBT_BLC` decimal(18,2) DEFAULT NULL,
  `OCD_PAYMONEY` decimal(18,2) DEFAULT NULL,
  `operator` varchar(32) DEFAULT NULL,
  `TE_NAME` varchar(64) DEFAULT NULL,
  `DELFLAG` TINYINT UNSIGNED,
  `canceler` varchar(32) DEFAULT NULL,
  `cancelDate` DATETIME DEFAULT NULL,
  `cancelReason` ENUM('00','01','02','03','04') DEFAULT '00',
  `BANKINGNO` varchar(32) DEFAULT NULL,
  PRIMARY KEY (`ORDERSID`, `OD_DATE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4
PARTITION BY RANGE (TO_DAYS(OD_DATE))(
    PARTITION P201500 VALUES LESS THAN (TO_DAYS('2015-01-01')) ENGINE = InnoDB,
    PARTITION P201501 VALUES LESS THAN (TO_DAYS('2015-02-01')) ENGINE = InnoDB,
    PARTITION P201502 VALUES LESS THAN (TO_DAYS('2015-03-01')) ENGINE = InnoDB,
    PARTITION P201503 VALUES LESS THAN (TO_DAYS('2015-04-01')) ENGINE = InnoDB,
    PARTITION P201504 VALUES LESS THAN (TO_DAYS('2015-05-01')) ENGINE = InnoDB,
    PARTITION P201505 VALUES LESS THAN (TO_DAYS('2015-06-01')) ENGINE = InnoDB,
    PARTITION P201506 VALUES LESS THAN (TO_DAYS('2015-07-01')) ENGINE = InnoDB,
    PARTITION P201507 VALUES LESS THAN (TO_DAYS('2015-08-01')) ENGINE = InnoDB,
    PARTITION P201508 VALUES LESS THAN (TO_DAYS('2015-09-01')) ENGINE = InnoDB,
    PARTITION P201509 VALUES LESS THAN (TO_DAYS('2015-10-01')) ENGINE = InnoDB,
    PARTITION P201510 VALUES LESS THAN (TO_DAYS('2015-11-01')) ENGINE = InnoDB,
    PARTITION P201511 VALUES LESS THAN (TO_DAYS('2015-12-01')) ENGINE = InnoDB,
    PARTITION P201512 VALUES LESS THAN (TO_DAYS('2016-01-01')) ENGINE = InnoDB,
    PARTITION PMAX VALUES LESS THAN (MAXVALUE)
);

CREATE TABLE `tmp_sdjl_2016` LIKE `tmp_sdjl_2015`;
ALTER TABLE `tmp_sdjl_2016`
PARTITION BY RANGE (TO_DAYS(OD_DATE))(
    PARTITION P201601 VALUES LESS THAN (TO_DAYS('2016-02-01')) ENGINE = InnoDB,
    PARTITION P201602 VALUES LESS THAN (TO_DAYS('2016-03-01')) ENGINE = InnoDB,
    PARTITION P201603 VALUES LESS THAN (TO_DAYS('2016-04-01')) ENGINE = InnoDB,
    PARTITION P201604 VALUES LESS THAN (TO_DAYS('2016-05-01')) ENGINE = InnoDB,
    PARTITION P201605 VALUES LESS THAN (TO_DAYS('2016-06-01')) ENGINE = InnoDB,
    PARTITION P201606 VALUES LESS THAN (TO_DAYS('2016-07-01')) ENGINE = InnoDB,
    PARTITION P201607 VALUES LESS THAN (TO_DAYS('2016-08-01')) ENGINE = InnoDB,
    PARTITION P201608 VALUES LESS THAN (TO_DAYS('2016-09-01')) ENGINE = InnoDB,
    PARTITION P201609 VALUES LESS THAN (TO_DAYS('2016-10-01')) ENGINE = InnoDB,
    PARTITION P201610 VALUES LESS THAN (TO_DAYS('2016-11-01')) ENGINE = InnoDB,
    PARTITION P201611 VALUES LESS THAN (TO_DAYS('2016-12-01')) ENGINE = InnoDB,
    PARTITION P201612 VALUES LESS THAN (TO_DAYS('2017-01-01')) ENGINE = InnoDB,
    PARTITION PMAX VALUES LESS THAN (MAXVALUE)
);

CREATE TABLE `tmp_sdjl_2017` LIKE `tmp_sdjl_2015`;
ALTER TABLE `tmp_sdjl_2017`
PARTITION BY RANGE (TO_DAYS(OD_DATE))(
    PARTITION P201701 VALUES LESS THAN (TO_DAYS('2017-02-01')) ENGINE = InnoDB,
    PARTITION P201702 VALUES LESS THAN (TO_DAYS('2017-03-01')) ENGINE = InnoDB,
    PARTITION P201703 VALUES LESS THAN (TO_DAYS('2017-04-01')) ENGINE = InnoDB,
    PARTITION P201704 VALUES LESS THAN (TO_DAYS('2017-05-01')) ENGINE = InnoDB,
    PARTITION P201705 VALUES LESS THAN (TO_DAYS('2017-06-01')) ENGINE = InnoDB,
    PARTITION P201706 VALUES LESS THAN (TO_DAYS('2017-07-01')) ENGINE = InnoDB,
    PARTITION P201707 VALUES LESS THAN (TO_DAYS('2017-08-01')) ENGINE = InnoDB,
    PARTITION P201708 VALUES LESS THAN (TO_DAYS('2017-09-01')) ENGINE = InnoDB,
    PARTITION P201709 VALUES LESS THAN (TO_DAYS('2017-10-01')) ENGINE = InnoDB,
    PARTITION P201710 VALUES LESS THAN (TO_DAYS('2017-11-01')) ENGINE = InnoDB,
    PARTITION P201711 VALUES LESS THAN (TO_DAYS('2017-12-01')) ENGINE = InnoDB,
    PARTITION P201712 VALUES LESS THAN (TO_DAYS('2018-01-01')) ENGINE = InnoDB,
    PARTITION PMAX VALUES LESS THAN (MAXVALUE)
);

CREATE TABLE `tmp_sdjl_2018` LIKE `tmp_sdjl_2015`;
ALTER TABLE `tmp_sdjl_2018`
PARTITION BY RANGE (TO_DAYS(OD_DATE))(
    PARTITION P201801 VALUES LESS THAN (TO_DAYS('2018-02-01')) ENGINE = InnoDB,
    PARTITION P201802 VALUES LESS THAN (TO_DAYS('2018-03-01')) ENGINE = InnoDB,
    PARTITION P201803 VALUES LESS THAN (TO_DAYS('2018-04-01')) ENGINE = InnoDB,
    PARTITION P201804 VALUES LESS THAN (TO_DAYS('2018-05-01')) ENGINE = InnoDB,
    PARTITION P201805 VALUES LESS THAN (TO_DAYS('2018-06-01')) ENGINE = InnoDB,
    PARTITION P201806 VALUES LESS THAN (TO_DAYS('2018-07-01')) ENGINE = InnoDB,
    PARTITION P201807 VALUES LESS THAN (TO_DAYS('2018-08-01')) ENGINE = InnoDB,
    PARTITION P201808 VALUES LESS THAN (TO_DAYS('2018-09-01')) ENGINE = InnoDB,
    PARTITION P201809 VALUES LESS THAN (TO_DAYS('2018-10-01')) ENGINE = InnoDB,
    PARTITION P201810 VALUES LESS THAN (TO_DAYS('2018-11-01')) ENGINE = InnoDB,
    PARTITION P201811 VALUES LESS THAN (TO_DAYS('2018-12-01')) ENGINE = InnoDB,
    PARTITION P201812 VALUES LESS THAN (TO_DAYS('2019-01-01')) ENGINE = InnoDB,
    PARTITION PMAX VALUES LESS THAN (MAXVALUE)
);

CREATE TABLE `tmp_sdjl_2019` LIKE `tmp_sdjl_2015`;
ALTER TABLE `tmp_sdjl_2019`
PARTITION BY RANGE (TO_DAYS(OD_DATE))(
    PARTITION P201901 VALUES LESS THAN (TO_DAYS('2019-02-01')) ENGINE = InnoDB,
    PARTITION P201902 VALUES LESS THAN (TO_DAYS('2019-03-01')) ENGINE = InnoDB,
    PARTITION P201903 VALUES LESS THAN (TO_DAYS('2019-04-01')) ENGINE = InnoDB,
    PARTITION P201904 VALUES LESS THAN (TO_DAYS('2019-05-01')) ENGINE = InnoDB,
    PARTITION P201905 VALUES LESS THAN (TO_DAYS('2019-06-01')) ENGINE = InnoDB,
    PARTITION P201906 VALUES LESS THAN (TO_DAYS('2019-07-01')) ENGINE = InnoDB,
    PARTITION P201907 VALUES LESS THAN (TO_DAYS('2019-08-01')) ENGINE = InnoDB,
    PARTITION P201908 VALUES LESS THAN (TO_DAYS('2019-09-01')) ENGINE = InnoDB,
    PARTITION P201909 VALUES LESS THAN (TO_DAYS('2019-10-01')) ENGINE = InnoDB,
    PARTITION P201910 VALUES LESS THAN (TO_DAYS('2019-11-01')) ENGINE = InnoDB,
    PARTITION P201911 VALUES LESS THAN (TO_DAYS('2019-12-01')) ENGINE = InnoDB,
    PARTITION P201912 VALUES LESS THAN (TO_DAYS('2020-01-01')) ENGINE = InnoDB,
    PARTITION PMAX VALUES LESS THAN (MAXVALUE)
);

CREATE TABLE `tmp_sdjl_2020` LIKE `tmp_sdjl_2015`;
ALTER TABLE `tmp_sdjl_2020`
PARTITION BY RANGE (TO_DAYS(OD_DATE))(
  PARTITION P202001 VALUES LESS THAN (TO_DAYS('2020-02-01')) ENGINE = InnoDB,
  PARTITION P202002 VALUES LESS THAN (TO_DAYS('2020-03-01')) ENGINE = InnoDB,
  PARTITION P202003 VALUES LESS THAN (TO_DAYS('2020-04-01')) ENGINE = InnoDB,
  PARTITION P202004 VALUES LESS THAN (TO_DAYS('2020-05-01')) ENGINE = InnoDB,
  PARTITION P202005 VALUES LESS THAN (TO_DAYS('2020-06-01')) ENGINE = InnoDB,
  PARTITION P202006 VALUES LESS THAN (TO_DAYS('2020-07-01')) ENGINE = InnoDB,
  PARTITION P202007 VALUES LESS THAN (TO_DAYS('2020-08-01')) ENGINE = InnoDB,
  PARTITION P202008 VALUES LESS THAN (TO_DAYS('2020-09-01')) ENGINE = InnoDB,
  PARTITION P202009 VALUES LESS THAN (TO_DAYS('2020-10-01')) ENGINE = InnoDB,
  PARTITION P202010 VALUES LESS THAN (TO_DAYS('2020-11-01')) ENGINE = InnoDB,
  PARTITION P202011 VALUES LESS THAN (TO_DAYS('2020-12-01')) ENGINE = InnoDB,
  PARTITION P202012 VALUES LESS THAN (TO_DAYS('2021-01-01')) ENGINE = InnoDB,
  PARTITION PMAX VALUES LESS THAN (MAXVALUE)
);
```

-- ------------------------------------------------------------------------------------------------------------------

```sql
select  t.ORDERSID,                                         -- 主键，票据编号
        m.MT_COMM_ADDR,                                     -- 表号
        t.OD_DATE as OD_DATE,                               -- 购电时间
        t.ISFREE,                                           -- 是否免费：0=正常购电；1=免费购电；
        t.USER_ID as CUSTOMER_ID,                           -- 户号
        ISNULL(RIGHT('000000'+CAST(om.SGCID_OLD as varchar(10)),6),'') as SGC_OLD,  -- 变更密钥前SGC
        ISNULL(CAST(om.TI_OLD AS VARCHAR(2)),'') TI_OLD,                            -- 变更密钥前TI
        ISNULL(CAST(om.KEYVERSIONID_OLD AS VARCHAR(2)),'') KEYVERSIONID_OLD,        -- 变更密钥前KRN
        ISNULL(CAST(om.KEYEXPIRY_OLD AS VARCHAR(3)),'') KEYEXPIRY_OLD,              -- 变更密钥前KEN 255
        RIGHT('000000'+CAST(t.SGCID as varchar(10)),6) as SGC,  -- 变更密钥后SGC
        t.TI,                                                   -- 变更密钥后TI
        t.KEYVERSIONID,                                         -- 变更密钥后KRN
        t.KEYEXPIRY,                                            -- 变更密钥后KEN 255
        t.OCD_TOKEN,                            -- Credit Token
        ISNULL(om.MAN_TOKEN1,'') KEYTOKEN1,     -- KEY Token 1
        ISNULL(om.MAN_TOKEN2,'') KEYTOKEN2,     -- KEY Token 2
        t.OCD_ENERGY,       -- 资源量
        t.OCD_MONEY,        -- 资源量金额
        t.PAYTYPE,          -- 支付方式：0=现金；1=信用卡；2=支票；3=第三方购电，采用现金；
        t.FP_VAL3,          -- 百分比税金额
        t.OCD_DEBT,         -- 还债金额
        t.DEBT_BLC,         -- 交易后剩余债务
        t.OCD_PAYMONEY,     -- 支付金额
        u.USER_ACCOUNT as operator,         -- 售电员
        ltrim(rtrim(cdu.TE_NAME)) TE_NAME,  -- 代理商名称
        t.DELFLAG,                              -- 是否撤单
        ISNULL(u2.USER_ACCOUNT,'') as canceler, -- 撤单操作员
        rv.OD_DATE as cancelDate,               -- 撤单时间
        (CASE rv.remark 
            WHEN 'WRONG TARIF CODE(SGC)' THEN '01' 
            WHEN 'WRONG AMOUNT ALLOCATION' THEN '02' 
            WHEN 'TEST TOKEN' THEN '04' ELSE '03' END) cancelReason,     -- 撤单原因，和系统VD_ORDER_CANCEL_RSN的code值匹配
        (select top 1 ob.BANKINGNO
            from ORDER_BANKING ob
            where ob.BATCHNO=0 and t.OD_DATE>=ob.STARTTIME
            and t.OD_DATE<=ob.ENDTIME and ob.CDUID=t.CDUID) BANKINGNO,  -- 所属日结单编号
        t.OD_DATE as TV     -- 分区字段
from ORDER_TRN t
inner join IPARA_MTRPOINT m on t.METERID=m.MTRPOINT_ID
inner join IPARA_RESIDENT r on r.CUSTOMER_ID=t.USER_ID
inner join IAUDIT_USER u on u.USER_ID=t.OPERATORID
inner join IPARA_CDUSTATION cdu on cdu.TERRITORYID=t.CDUID
left join ORDER_MANAGE om on om.ORDERSID=t.ORDERSID
left join ORDER_REVERSED rv on rv.ORDERSID=t.ORDERSID
left join IAUDIT_USER u2 on u2.USER_ID=rv.OPERATORID
where year(t.OD_DATE)=2015 and month(t.od_date) = 1
```
```sql
-- 自己先四舍五入+优化字段
select  t.ORDERSID,                                         -- 主键，票据编号
        m.MT_COMM_ADDR,                                     -- 表号
        t.OD_DATE as OD_DATE,                               -- 购电时间
        t.ISFREE,                                           -- 是否免费：0=正常购电；1=免费购电；
        t.USER_ID as CUSTOMER_ID,                           -- 户号
        ISNULL(RIGHT('000000'+CAST(om.SGCID_OLD as varchar(10)),6),'00') as SGC_OLD,  -- 变更密钥前SGC
        ISNULL(om.TI_OLD,0) as TI_OLD,                            -- 变更密钥前TI
        ISNULL(om.KEYVERSIONID_OLD,0) as KEYVERSIONID_OLD,        -- 变更密钥前KRN
        ISNULL(om.KEYEXPIRY_OLD,0) as KEYEXPIRY_OLD,              -- 变更密钥前KEN 255
        RIGHT('000000'+CAST(t.SGCID as varchar(10)),6) as SGC,  -- 变更密钥后SGC
        t.TI,                                                   -- 变更密钥后TI
        t.KEYVERSIONID,                                         -- 变更密钥后KRN
        t.KEYEXPIRY,                                            -- 变更密钥后KEN 255
        t.OCD_TOKEN,                            -- Credit Token
        ISNULL(om.MAN_TOKEN1,'00') as KEYTOKEN1,     -- KEY Token 1
        ISNULL(om.MAN_TOKEN2,'00') as KEYTOKEN2,     -- KEY Token 2
        round(t.OCD_ENERGY,2) as OCD_ENERGY,       -- 资源量
        round(t.OCD_MONEY,2)  as OCD_MONEY,        -- 资源量金额
        t.PAYTYPE,          -- 支付方式：0=现金；1=信用卡；2=支票；3=第三方购电，采用现金；
        round(t.FP_VAL3,2) as FP_VAL3,          -- 百分比税金额
        round(t.OCD_DEBT,2) as OCD_DEBT,         -- 还债金额
        round(t.DEBT_BLC,2) as DEBT_BLC,         -- 交易后剩余债务
        round(t.OCD_PAYMONEY,2) as OCD_PAYMONEY,     -- 支付金额
        u.USER_ACCOUNT as operator,         -- 售电员
        ltrim(rtrim(cdu.TE_NAME)) as TE_NAME,  -- 代理商名称
        t.DELFLAG,                              -- 是否撤单
        ISNULL(u2.USER_ACCOUNT,'') as canceler, -- 撤单操作员
        rv.OD_DATE as cancelDate,               -- 撤单时间
        (CASE rv.remark 
            WHEN 'WRONG TARIF CODE(SGC)' THEN '01' 
            WHEN 'WRONG AMOUNT ALLOCATION' THEN '02' 
            WHEN 'TEST TOKEN' THEN '04' ELSE '03' END) as cancelReason,     -- 撤单原因，和系统VD_ORDER_CANCEL_RSN的code值匹配
        (select top 1 ob.BANKINGNO
            from ORDER_BANKING ob
            where ob.BATCHNO=0 and t.OD_DATE>=ob.STARTTIME
            and t.OD_DATE<=ob.ENDTIME and ob.CDUID=t.CDUID) as BANKINGNO    -- 所属日结单编号
from ORDER_TRN t
inner join IPARA_MTRPOINT m on t.METERID=m.MTRPOINT_ID
inner join IPARA_RESIDENT r on r.CUSTOMER_ID=t.USER_ID
inner join IAUDIT_USER u on u.USER_ID=t.OPERATORID
inner join IPARA_CDUSTATION cdu on cdu.TERRITORYID=t.CDUID
left join ORDER_MANAGE om on om.ORDERSID=t.ORDERSID
left join ORDER_REVERSED rv on rv.ORDERSID=t.ORDERSID
left join IAUDIT_USER u2 on u2.USER_ID=rv.OPERATORID
where year(t.OD_DATE)=2015 and month(t.od_date) = 1
```

------------------作废---------------------
```sql
PARTITION P201501 VALUES LESS THAN (TO_DAYS('2015-01-31')) ENGINE = InnoDB,
PARTITION P201502 VALUES LESS THAN (TO_DAYS('2015-02-28')) ENGINE = InnoDB,
PARTITION P201503 VALUES LESS THAN (TO_DAYS('2015-03-31')) ENGINE = InnoDB,
PARTITION P201504 VALUES LESS THAN (TO_DAYS('2015-04-30')) ENGINE = InnoDB,
PARTITION P201505 VALUES LESS THAN (TO_DAYS('2015-05-31')) ENGINE = InnoDB,
PARTITION P201506 VALUES LESS THAN (TO_DAYS('2015-06-30')) ENGINE = InnoDB,
PARTITION P201507 VALUES LESS THAN (TO_DAYS('2015-07-31')) ENGINE = InnoDB,
PARTITION P201508 VALUES LESS THAN (TO_DAYS('2015-08-31')) ENGINE = InnoDB,
PARTITION P201509 VALUES LESS THAN (TO_DAYS('2015-09-30')) ENGINE = InnoDB,
PARTITION P201510 VALUES LESS THAN (TO_DAYS('2015-10-31')) ENGINE = InnoDB,
PARTITION P201511 VALUES LESS THAN (TO_DAYS('2015-11-30')) ENGINE = InnoDB,
PARTITION P201512 VALUES LESS THAN (TO_DAYS('2015-12-31')) ENGINE = InnoDB,
PARTITION P201601 VALUES LESS THAN (TO_DAYS('2016-01-31')) ENGINE = InnoDB,
PARTITION P201602 VALUES LESS THAN (TO_DAYS('2016-02-29')) ENGINE = InnoDB,
PARTITION P201603 VALUES LESS THAN (TO_DAYS('2016-03-31')) ENGINE = InnoDB,
PARTITION P201604 VALUES LESS THAN (TO_DAYS('2016-04-30')) ENGINE = InnoDB,
PARTITION P201605 VALUES LESS THAN (TO_DAYS('2016-05-31')) ENGINE = InnoDB,
PARTITION P201606 VALUES LESS THAN (TO_DAYS('2016-06-30')) ENGINE = InnoDB,
PARTITION P201607 VALUES LESS THAN (TO_DAYS('2016-07-31')) ENGINE = InnoDB,
PARTITION P201608 VALUES LESS THAN (TO_DAYS('2016-08-31')) ENGINE = InnoDB,
PARTITION P201609 VALUES LESS THAN (TO_DAYS('2016-09-30')) ENGINE = InnoDB,
PARTITION P201610 VALUES LESS THAN (TO_DAYS('2016-10-31')) ENGINE = InnoDB,
PARTITION P201611 VALUES LESS THAN (TO_DAYS('2016-11-30')) ENGINE = InnoDB,
PARTITION P201612 VALUES LESS THAN (TO_DAYS('2016-12-31')) ENGINE = InnoDB,
PARTITION P201701 VALUES LESS THAN (TO_DAYS('2017-01-31')) ENGINE = InnoDB,
PARTITION P201702 VALUES LESS THAN (TO_DAYS('2017-02-28')) ENGINE = InnoDB,
PARTITION P201703 VALUES LESS THAN (TO_DAYS('2017-03-31')) ENGINE = InnoDB,
PARTITION P201704 VALUES LESS THAN (TO_DAYS('2017-04-30')) ENGINE = InnoDB,
PARTITION P201705 VALUES LESS THAN (TO_DAYS('2017-05-31')) ENGINE = InnoDB,
PARTITION P201706 VALUES LESS THAN (TO_DAYS('2017-06-30')) ENGINE = InnoDB,
PARTITION P201707 VALUES LESS THAN (TO_DAYS('2017-07-31')) ENGINE = InnoDB,
PARTITION P201708 VALUES LESS THAN (TO_DAYS('2017-08-31')) ENGINE = InnoDB,
PARTITION P201709 VALUES LESS THAN (TO_DAYS('2017-09-30')) ENGINE = InnoDB,
PARTITION P201710 VALUES LESS THAN (TO_DAYS('2017-10-31')) ENGINE = InnoDB,
PARTITION P201711 VALUES LESS THAN (TO_DAYS('2017-11-30')) ENGINE = InnoDB,
PARTITION P201712 VALUES LESS THAN (TO_DAYS('2017-12-31')) ENGINE = InnoDB,
PARTITION P201801 VALUES LESS THAN (TO_DAYS('2018-01-31')) ENGINE = InnoDB,
PARTITION P201802 VALUES LESS THAN (TO_DAYS('2018-02-28')) ENGINE = InnoDB,
PARTITION P201803 VALUES LESS THAN (TO_DAYS('2018-03-31')) ENGINE = InnoDB,
PARTITION P201804 VALUES LESS THAN (TO_DAYS('2018-04-30')) ENGINE = InnoDB,
PARTITION P201805 VALUES LESS THAN (TO_DAYS('2018-05-31')) ENGINE = InnoDB,
PARTITION P201806 VALUES LESS THAN (TO_DAYS('2018-06-30')) ENGINE = InnoDB,
PARTITION P201807 VALUES LESS THAN (TO_DAYS('2018-07-31')) ENGINE = InnoDB,
PARTITION P201808 VALUES LESS THAN (TO_DAYS('2018-08-31')) ENGINE = InnoDB,
PARTITION P201809 VALUES LESS THAN (TO_DAYS('2018-09-30')) ENGINE = InnoDB,
PARTITION P201810 VALUES LESS THAN (TO_DAYS('2018-10-31')) ENGINE = InnoDB,
PARTITION P201811 VALUES LESS THAN (TO_DAYS('2018-11-30')) ENGINE = InnoDB,
PARTITION P201812 VALUES LESS THAN (TO_DAYS('2018-12-31')) ENGINE = InnoDB,
PARTITION P201901 VALUES LESS THAN (TO_DAYS('2019-01-31')) ENGINE = InnoDB,
PARTITION P201902 VALUES LESS THAN (TO_DAYS('2019-02-28')) ENGINE = InnoDB,
PARTITION P201903 VALUES LESS THAN (TO_DAYS('2019-03-31')) ENGINE = InnoDB,
PARTITION P201904 VALUES LESS THAN (TO_DAYS('2019-04-30')) ENGINE = InnoDB,
PARTITION P201905 VALUES LESS THAN (TO_DAYS('2019-05-31')) ENGINE = InnoDB,
PARTITION P201906 VALUES LESS THAN (TO_DAYS('2019-06-30')) ENGINE = InnoDB,
PARTITION P201907 VALUES LESS THAN (TO_DAYS('2019-07-31')) ENGINE = InnoDB,
PARTITION P201908 VALUES LESS THAN (TO_DAYS('2019-08-31')) ENGINE = InnoDB,
PARTITION P201909 VALUES LESS THAN (TO_DAYS('2019-09-30')) ENGINE = InnoDB,
PARTITION P201910 VALUES LESS THAN (TO_DAYS('2019-10-31')) ENGINE = InnoDB,
PARTITION P201911 VALUES LESS THAN (TO_DAYS('2019-11-30')) ENGINE = InnoDB,
PARTITION P201912 VALUES LESS THAN (TO_DAYS('2019-12-31')) ENGINE = InnoDB,
PARTITION P202001 VALUES LESS THAN (TO_DAYS('2020-01-31')) ENGINE = InnoDB,
PARTITION P202002 VALUES LESS THAN (TO_DAYS('2020-02-29')) ENGINE = InnoDB,
PARTITION P202003 VALUES LESS THAN (TO_DAYS('2020-03-31')) ENGINE = InnoDB,
PARTITION P202004 VALUES LESS THAN (TO_DAYS('2020-04-30')) ENGINE = InnoDB,
PARTITION P202005 VALUES LESS THAN (TO_DAYS('2020-05-31')) ENGINE = InnoDB,
PARTITION P202006 VALUES LESS THAN (TO_DAYS('2020-06-30')) ENGINE = InnoDB,
PARTITION P202007 VALUES LESS THAN (TO_DAYS('2020-07-31')) ENGINE = InnoDB,
PARTITION P202008 VALUES LESS THAN (TO_DAYS('2020-08-31')) ENGINE = InnoDB,
PARTITION P202009 VALUES LESS THAN (TO_DAYS('2020-09-30')) ENGINE = InnoDB,
PARTITION P202010 VALUES LESS THAN (TO_DAYS('2020-10-31')) ENGINE = InnoDB,
PARTITION P202011 VALUES LESS THAN (TO_DAYS('2020-11-30')) ENGINE = InnoDB,
PARTITION P202012 VALUES LESS THAN (TO_DAYS('2020-12-31')) ENGINE = InnoDB,
PARTITION PMAX VALUES LESS THAN (MAXVALUE)
```