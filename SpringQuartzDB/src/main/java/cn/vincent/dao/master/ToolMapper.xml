<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.vincent.dao.master.ToolDao">

    <select id="queryTableExist" resultType="java.lang.Integer">
        select COUNT(1) FROM information_schema.`TABLES` where TABLE_NAME = #{tableName}
    </select>

    <select id="queryTableSize" resultType="java.lang.Integer">
        select count(1) from ${tableName}
    </select>

    <update id="updateCreateTmpCentlec">
        CREATE TABLE `tmp_centlec` (
            `id` int(11) NOT NULL AUTO_INCREMENT,
            `syn_date` varchar(8) NOT NULL,
            `cur_dead_step` varchar(8) NOT NULL,
            `remark` varchar(64) DEFAULT NULL,
            `tv` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
            PRIMARY KEY (`id`)
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
    </update>
    <select id="queryTableNameList" resultType="java.lang.String">
        SELECT TABLE_NAME FROM information_schema.`TABLES` WHERE TABLE_NAME LIKE CONCAT(#{tableBaseName},'2020%')
    </select>
    <update id="updateDropTableByName">
        DROP TABLE IF EXISTS ${tableName}
    </update>
    <update id="updateAlterTableByName">
        ALTER TABLE ${oldName} RENAME TO ${newName}
    </update>
    <update id="updateCreateTmpLjz">
        CREATE TABLE `tmp_ljz` (
          `energy` varchar(128) DEFAULT NULL,
          `MT_COMM_ADDR` varchar(128) NOT NULL,
          `LASTVENDDATE` varchar(128) NOT NULL,
          `ISFREE` varchar(128) NOT NULL,
          `ISUSED` varchar(128) NOT NULL,
          `meterId` varchar(128) DEFAULT NULL COMMENT 'NULL',
          `consId` varchar(128) DEFAULT NULL COMMENT 'NULL',
          `energy_old` varchar(128) DEFAULT NULL COMMENT 'NULL',
          `MT_COMM_ADDR_old` varchar(128) DEFAULT NULL COMMENT 'NULL',
          `LASTVENDDATE_old` varchar(128) DEFAULT NULL COMMENT 'NULL',
          `ISFREE_old` varchar(128) DEFAULT NULL COMMENT 'NULL',
          `ISUSED_old` varchar(128) DEFAULT NULL COMMENT 'NULL',
          PRIMARY KEY (`MT_COMM_ADDR`,`LASTVENDDATE`,`ISFREE`)
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
    </update>
    <select id="queryMaxLastVendDateFromLjz1" resultType="java.lang.String">
        select max(lastvenddate) from tmp_ljz1
    </select>
</mapper>